//Ngan Kim Khong's algos.